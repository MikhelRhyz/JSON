<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSON Data Processing Challenge</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .challenge-container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        .challenge-header {
            background: linear-gradient(90deg, #2c3e50, #4ca1af);
            color: white;
            padding: 25px;
            text-align: center;
        }
        .challenge-body {
            padding: 25px;
        }
        .scenario-box {
            background-color: #f8f9fa;
            border-left: 5px solid #4ca1af;
            padding: 20px;
            margin-bottom: 25px;
            border-radius: 0 8px 8px 0;
        }
        .data-box {
            background-color: #e9ecef;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            max-height: 300px;
            overflow-y: auto;
        }
        .tasks-list {
            list-style-type: none;
            padding-left: 0;
        }
        .tasks-list li {
            padding: 10px 15px;
            margin-bottom: 10px;
            background-color: #f1f8ff;
            border-left: 4px solid #4dabf7;
            border-radius: 0 5px 5px 0;
        }
        .tasks-list li:nth-child(even) {
            background-color: #f8f9fa;
            border-left-color: #69db7c;
        }
        .code-editor {
            width: 100%;
            min-height: 200px;
            font-family: 'Courier New', monospace;
            padding: 15px;
            border: 1px solid #ced4da;
            border-radius: 5px;
            margin: 15px 0;
            resize: vertical;
        }
        .btn-run {
            background: linear-gradient(90deg, #4facfe 0%, #00f2fe 100%);
            border: none;
            color: white;
            padding: 12px 25px;
            border-radius: 50px;
            font-weight: 600;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(79, 172, 254, 0.3);
        }
        .btn-run:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(79, 172, 254, 0.4);
        }
        .results-area {
            min-height: 200px;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            background-color: #f8f9fa;
            display: none;
        }
        .result-item {
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 5px;
            background-color: white;
            border-left: 4px solid #4dabf7;
        }
        .result-item.success {
            border-left-color: #51cf66;
            background-color: #ebfbee;
        }
        .result-item.error {
            border-left-color: #ff6b6b;
            background-color: #fff5f5;
        }
        .progress-container {
            height: 10px;
            background-color: #e9ecef;
            border-radius: 5px;
            margin: 20px 0;
            overflow: hidden;
        }
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #4facfe 0%, #00f2fe 100%);
            width: 0%;
            transition: width 0.5s;
        }
        .badge {
            font-size: 14px;
            padding: 5px 10px;
            border-radius: 20px;
        }
        .hint-box {
            background-color: #fff3cd;
            border-left: 4px solid #ffd43b;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 5px 5px 0;
            display: none;
        }
    </style>
</head>
<body>
    <div class="challenge-container">
        <div class="challenge-header">
            <h1>JSON Data Processing Challenge</h1>
            <p class="lead">Process company data to generate meaningful reports</p>
            <p>you can view sample solution on sampleSolutions.js file</p>
        </div>
        
        <div class="challenge-body">
            <div class="scenario-box">
                <h3>üìä Scenario: Company Data Analyst</h3>
                <p>You're a data analyst at TechCorp Inc. Your manager has given you raw JSON data about employees, projects, and departments. You need to process this data to generate useful reports for management.</p>
            </div>
            
            <h4>üìÅ Raw Data</h4>
            <div class="data-box" id="rawData">
                {/* JSON data will be inserted here by JavaScript */}
            </div>
            
            <h4>üéØ Your Tasks</h4>
            <ol class="tasks-list">
                <li><strong>Task 1:</strong> Calculate the average salary for each department</li>
                <li><strong>Task 2:</strong> Find employees who are working on more than 2 projects</li>
                <li><strong>Task 3:</strong> Identify departments with above-average employee counts</li>
                <li><strong>Task 4:</strong> Create a summary of each department's total project budget</li>
                <li><strong>Task 5:</strong> Generate a report of employees eligible for promotion (3+ years at company)</li>
            </ol>
            
            <div class="progress-container">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            
            <h4>üíª Your Solution</h4>
            <p>Write JavaScript code to process the data and complete all tasks. Your code should output the results in a specific format.</p>
            
            <textarea class="code-editor" id="codeEditor" placeholder="// Write your JavaScript code here
// Use the provided data variable
// Output your results using console.log()"></textarea>
            
            <div class="d-flex justify-content-between align-items-center">
                <button class="btn btn-run" id="runCode">Run Code & Check Results</button>
                <button class="btn btn-outline-secondary" id="showHint">Show Hint</button>
            </div>
            
            <div class="hint-box" id="hintBox">
                <h5>üí° Hint</h5>
                <p>Break down the problem into smaller steps:</p>
                <ul>
                    <li>First, parse and understand the structure of the JSON data</li>
                    <li>Use array methods like map, filter, and reduce to process the data</li>
                    <li>Create helper functions for each task to keep your code organized</li>
                    <li>Remember to handle nested data structures appropriately</li>
                </ul>
                <p><strong>Example starter code:</strong></p>
                <pre>// Calculate average salary by department
function avgSalaryByDept(data) {
  // Your code here
}</pre>
            </div>
            
            <div class="results-area" id="resultsArea">
                <h4>üìà Results</h4>
                <div id="resultsContainer">
                    {/* Results will be inserted here by JavaScript */}
                </div>
            </div>
        </div>
    </div>

    <script>
        // Sample data for the challenge
        const companyData = {
            company: "TechCorp Inc.",
            departments: [
                {
                    id: 1,
                    name: "Engineering",
                    budget: 500000,
                    employees: [
                        { id: 101, name: "Alice Johnson", salary: 85000, yearsAtCompany: 4, projects: [1, 3] },
                        { id: 102, name: "Bob Smith", salary: 92000, yearsAtCompany: 2, projects: [1, 2, 4] },
                        { id: 103, name: "Carol Davis", salary: 78000, yearsAtCompany: 5, projects: [3] },
                        { id: 104, name: "David Wilson", salary: 95000, yearsAtCompany: 3, projects: [2, 4] }
                    ]
                },
                {
                    id: 2,
                    name: "Marketing",
                    budget: 300000,
                    employees: [
                        { id: 201, name: "Eva Brown", salary: 65000, yearsAtCompany: 1, projects: [5] },
                        { id: 202, name: "Frank Miller", salary: 72000, yearsAtCompany: 4, projects: [5, 6] },
                        { id: 203, name: "Grace Lee", salary: 68000, yearsAtCompany: 2, projects: [6, 7] }
                    ]
                },
                {
                    id: 3,
                    name: "Sales",
                    budget: 450000,
                    employees: [
                        { id: 301, name: "Henry Clark", salary: 70000, yearsAtCompany: 3, projects: [8, 9] },
                        { id: 302, name: "Ivy Garcia", salary: 75000, yearsAtCompany: 6, projects: [8, 9, 10] },
                        { id: 303, name: "Jack Martinez", salary: 68000, yearsAtCompany: 2, projects: [10] },
                        { id: 304, name: "Karen Taylor", salary: 82000, yearsAtCompany: 4, projects: [8] },
                        { id: 305, name: "Leo Anderson", salary: 79000, yearsAtCompany: 1, projects: [9, 10] }
                    ]
                }
            ],
            projects: [
                { id: 1, name: "Website Redesign", budget: 50000, departmentId: 1 },
                { id: 2, name: "Mobile App", budget: 75000, departmentId: 1 },
                { id: 3, name: "Database Optimization", budget: 30000, departmentId: 1 },
                { id: 4, name: "API Development", budget: 45000, departmentId: 1 },
                { id: 5, name: "Social Media Campaign", budget: 25000, departmentId: 2 },
                { id: 6, name: "Product Launch", budget: 40000, departmentId: 2 },
                { id: 7, name: "Market Research", budget: 20000, departmentId: 2 },
                { id: 8, name: "Client Portal", budget: 35000, departmentId: 3 },
                { id: 9, name: "Sales Training", budget: 15000, departmentId: 3 },
                { id: 10, name: "CRM Implementation", budget: 60000, departmentId: 3 }
            ]
        };

        // Display the raw data in a formatted way
        document.getElementById('rawData').textContent = JSON.stringify(companyData, null, 2);

        // Set up event listeners
        document.getElementById('runCode').addEventListener('click', runCode);
        document.getElementById('showHint').addEventListener('click', function() {
            const hintBox = document.getElementById('hintBox');
            hintBox.style.display = hintBox.style.display === 'block' ? 'none' : 'block';
        });

        // Function to run the user's code and check results
        function runCode() {
            const userCode = document.getElementById('codeEditor').value;
            const resultsContainer = document.getElementById('resultsContainer');
            const resultsArea = document.getElementById('resultsArea');
            const progressBar = document.getElementById('progressBar');
            
            // Reset UI
            resultsContainer.innerHTML = '';
            resultsArea.style.display = 'block';
            progressBar.style.width = '0%';
            
            try {
                // Capture console.log output
                let consoleOutput = [];
                const originalLog = console.log;
                console.log = function(...args) {
                    consoleOutput.push(args.map(arg => 
                        typeof arg === 'object' ? JSON.stringify(arg, null, 2) : String(arg)
                    ).join(' '));
                    originalLog.apply(console, args);
                };
                
                // Execute user code with the data
                eval(`
                    const data = ${JSON.stringify(companyData)};
                    ${userCode}
                `);
                
                // Restore original console.log
                console.log = originalLog;
                
                // Display the output
                if (consoleOutput.length > 0) {
                    consoleOutput.forEach(output => {
                        const resultItem = document.createElement('div');
                        resultItem.className = 'result-item';
                        resultItem.innerHTML = `<pre>${output}</pre>`;
                        resultsContainer.appendChild(resultItem);
                    });
                    
                    // Simple progress indicator based on output length
                    const progress = Math.min(consoleOutput.length * 20, 100);
                    progressBar.style.width = `${progress}%`;
                    
                    // Check if all tasks might be completed
                    if (consoleOutput.length >= 5) {
                        const completionMsg = document.createElement('div');
                        completionMsg.className = 'result-item success';
                        completionMsg.innerHTML = '<strong>‚úÖ Great job! You\'ve completed all tasks.</strong>';
                        resultsContainer.appendChild(completionMsg);
                    }
                } else {
                    resultsContainer.innerHTML = '<div class="result-item error">No output detected. Make sure to use console.log() to display your results.</div>';
                }
                
            } catch (error) {
                resultsContainer.innerHTML = `<div class="result-item error"><strong>Error:</strong> ${error.message}</div>`;
            }
        }

        // Add example code to the editor
        document.getElementById('codeEditor').value = `// Example starter code - Complete the functions below

// Task 1: Calculate average salary by department
function calculateAvgSalaryByDept(data) {
  const result = {};
  // Your code here
  return result;
}

// Task 2: Find employees working on more than 2 projects
function findBusyEmployees(data) {
  const busyEmployees = [];
  // Your code here
  return busyEmployees;
}

// Task 3: Identify departments with above-average employee counts
function findLargeDepartments(data) {
  const largeDepts = [];
  // Your code here
  return largeDepts;
}

// Task 4: Create department project budget summary
function departmentBudgetSummary(data) {
  const summary = {};
  // Your code here
  return summary;
}

// Task 5: Find employees eligible for promotion (3+ years at company)
function findPromotionEligible(data) {
  const eligible = [];
  // Your code here
  return eligible;
}

// Run your functions and display results
console.log("=== Task 1: Average Salary by Department ===");
console.log(calculateAvgSalaryByDept(data));

console.log("\\\\n=== Task 2: Employees with >2 Projects ===");
console.log(findBusyEmployees(data));

console.log("\\\\n=== Task 3: Departments with Above-Average Size ===");
console.log(findLargeDepartments(data));

console.log("\\\\n=== Task 4: Department Budget Summary ===");
console.log(departmentBudgetSummary(data));

console.log("\\\\n=== Task 5: Promotion-Eligible Employees ===");
console.log(findPromotionEligible(data));
`;
    </script>
</body>
</html>